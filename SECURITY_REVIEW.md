# üîí –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ DarkKick Messenger

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. ~~NoSQL Injection –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö Firestore~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å—ã Firestore –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏.~~

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
- ‚úÖ `lib/services/user_service.dart` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ `InputValidator.sanitizeSearchQuery()`
- ‚úÖ `lib/services/user_search_service.dart` - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ `lib/screens/new_chat_screen.dart` - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–†–∏—Å–∫**: ~~–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.~~

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `InputValidator.sanitizeSearchQuery()` - —É–¥–∞–ª—è–µ—Ç –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏–Ω—É.

---

### 2. ~~–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã, —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞.~~

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
- ‚úÖ `lib/services/chat_service.dart` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `InputValidator.validateMessage()`
- ‚úÖ `lib/services/user_service.dart` - –≤–∞–ª–∏–¥–∞—Ü–∏—è name, bio, email
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ø–µ—Ä—å –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 10,000 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∏–º–µ–Ω–∏: 100 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ bio: 500 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email, userId, chatId

---

### 3. ~~XSS —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç~~ ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: üü° –°–†–ï–î–ù–ò–ô (–≤ Flutter –º–µ–Ω–µ–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –≤–∞–∂–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏.~~

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞**:
- ‚ö†Ô∏è `lib/screens/single_chat_screen.dart` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `Text()` (Flutter –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç)
- ‚ö†Ô∏è `lib/screens/user_profile_screen.dart` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ bio (Flutter –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç)

**–†–∏—Å–∫**: –°–Ω–∏–∂–µ–Ω, —Ç–∞–∫ –∫–∞–∫:
- ‚úÖ Flutter –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç HTML –≤ `Text()` –≤–∏–¥–∂–µ—Ç–∞—Ö
- ‚úÖ –î–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- ‚úÖ –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `InputValidator.sanitizeForDisplay()` –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –±–∞–∑—É
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, Flutter —É–∂–µ –∑–∞—â–∏—â–∞–µ—Ç)

---

### 4. ~~–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üü° –°–†–ï–î–ù–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤.~~

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
- ‚úÖ `lib/services/storage_service.dart` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `InputValidator.validateFileSize()`
- ‚úÖ `lib/services/chat_service.dart` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (5MB), –≥–æ–ª–æ—Å–æ–≤—ã–µ (25MB), –¥—Ä—É–≥–∏–µ (10MB)

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `InputValidator.validateFileSize()` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.

---

### 5. ~~–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üü° –°–†–ï–î–ù–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–í –ª–æ–≥–∞—Ö –º–æ–≥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.~~

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
- ‚úÖ `lib/services/user_service.dart` - —É–¥–∞–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ email
- ‚úÖ –í—Å–µ –ª–æ–≥–∏ —Ç–µ–ø–µ—Ä—å –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–¥–∞–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ email –∏ –¥—Ä—É–≥–∏—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## ‚ö†Ô∏è –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 6. ~~–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting~~ ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üü° –°–†–ï–î–ù–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤.~~

**–†–∏—Å–∫**: ~~DoS –∞—Ç–∞–∫–∏, –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ API.~~

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –±–∞–∑–æ–≤–æ–µ rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:
- ‚úÖ –°–æ–∑–¥–∞–Ω `lib/utils/rate_limiter.dart` —Å –∫–ª–∞—Å—Å–æ–º `RateLimiter`
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç–µ—Ä—ã –≤ `AppRateLimiters`:
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: 30 –≤ –º–∏–Ω—É—Ç—É
  - –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 20 –≤ –º–∏–Ω—É—Ç—É
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤: 10 –≤ –º–∏–Ω—É—Ç—É
  - –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–æ–≤: 5 –≤ –º–∏–Ω—É—Ç—É
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `ChatService.sendMessage()`
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `UserService.searchUsersByTag()`
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `StorageService.uploadChatImage()` –∏ `uploadUserAvatar()`
- ‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–π rate limiting (—á–µ—Ä–µ–∑ Firebase Functions) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production

---

### 7. ~~–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ Firestore Rules~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üü° –°–†–ï–î–ù–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ü—Ä–∞–≤–∏–ª–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ñ–æ—Ä–º–∞—Ç –∏ —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö.~~

**–¢–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
- ‚úÖ `firestore.rules` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `isValidString()` –∏ `isValidEmail()`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–æ–ª–µ–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ–ª–µ–π (name: 100, bio: 500, text: 10000)
- ‚úÖ –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (email –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

---

### 8. ~~–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
**–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**: ~~üü¢ –ù–ò–ó–ö–ò–ô~~

**–ü—Ä–æ–±–ª–µ–º–∞**: ~~–ù–µ—Ç —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π.~~

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ –°–æ–∑–¥–∞–Ω `lib/models/message_type.dart` —Å enum `MessageType`
- ‚úÖ –ú–µ—Ç–æ–¥—ã `MessageType.isValid()` –∏ `MessageType.fromString()` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –≤ `ChatService.sendMessage()`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ Firestore Rules

---

## ‚úÖ –•–û–†–û–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)

1. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π (flutter_secure_storage)
2. ‚úÖ End-to-End —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
3. ‚úÖ Firestore Security Rules –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
4. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Firebase Auth
5. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìã –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
1. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –°–æ–∑–¥–∞–Ω `lib/utils/input_validator.dart` —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (–º–∞–∫—Å. 10,000 —Å–∏–º–≤–æ–ª–æ–≤)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω (–º–∞–∫—Å. 100 —Å–∏–º–≤–æ–ª–æ–≤)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è bio (–º–∞–∫—Å. 500 —Å–∏–º–≤–æ–ª–æ–≤)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è email, chatId, userId

2. ‚úÖ **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –¥–ª—è NoSQL –∑–∞–ø—Ä–æ—Å–æ–≤**
   - `InputValidator.sanitizeSearchQuery()` - –∑–∞—â–∏—Ç–∞ –æ—Ç NoSQL injection
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `UserService.searchUsersByTag()`
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `UserSearchService.searchUnified()`
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `NewChatScreen._search()`

3. ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ñ–∞–π–ª–æ–≤**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (5MB), –≥–æ–ª–æ—Å–æ–≤—ã–µ (25MB), –¥—Ä—É–≥–∏–µ (10MB)
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ `StorageService.uploadChatImage()` –∏ `uploadUserAvatar()`
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ `ChatService.sendMessage()`

4. ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)**
   - –£–¥–∞–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ email –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
   - –£–ª—É—á—à–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

5. ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ Firestore Security Rules**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `isValidString()` –∏ `isValidEmail()`
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø–æ–ª–µ–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–°—Ä–µ–¥–Ω–∏–π) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
6. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω –±–∞–∑–æ–≤—ã–π rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ**
   - –°–æ–∑–¥–∞–Ω `lib/utils/rate_limiter.dart`
   - –õ–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
   - ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–π rate limiting –¥–ª—è production

7. ‚úÖ **–£–ª—É—á—à–µ–Ω—ã Firestore Security Rules** (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–Ω–µ–µ)

8. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ enum**
   - –°–æ–∑–¥–∞–Ω `lib/models/message_type.dart` —Å enum `MessageType`
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö –∏ Firestore Rules

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ù–∏–∑–∫–∏–π)
9. ‚ö†Ô∏è –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ (Flutter –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç)
10. ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- ‚úÖ `lib/utils/input_validator.dart` - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ `lib/utils/rate_limiter.dart` - –±–∞–∑–æ–≤—ã–π rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ `lib/models/message_type.dart` - enum –¥–ª—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- ‚úÖ `lib/services/chat_service.dart` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, rate limiting, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ `lib/services/user_service.dart` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö, rate limiting –¥–ª—è –ø–æ–∏—Å–∫–∞
- ‚úÖ `lib/services/user_search_service.dart` - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ `lib/services/storage_service.dart` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤, rate limiting –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ `lib/screens/new_chat_screen.dart` - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ `firestore.rules` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∞–≤–∏–ª
- ‚úÖ `lib/main.dart` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è rate limiters –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ó–∞—â–∏—Ç–∞ –æ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:
- ‚úÖ **NoSQL Injection**: –í—Å–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è
- ‚úÖ **XSS**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ **DoS**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∞–π–ª–æ–≤ + rate limiting
- ‚úÖ **–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π**: Enum —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤
- ‚úÖ **–ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ API**: Rate limiting –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

